# 过程控制的机制
- 过程控制：指程序在执行过程中如何管理和控制不同的代码块（如函数或子程序）的调用和返回
	- 例：如下两个代码块：
```
# 代码块P，主程序
P(...) {
	...
	...
	y = Q(x);
	print(y)
	...
}

# 代码块Q，被调用的子程序
int Q(int i) {
	int t = 3*i;
	int v[10];
	...
	...
	return v[t];
}
```
- 过程控制的关键问题：
	- 传递控制：在调用代码块Q时，如何保存当前代码块P的执行状态以及节点，以便在Q执行完毕后能够正确返回到P的正确位置继续执行
	- 传递数据：在调用代码块Q时，如何传递参数（如x）以及如何返回结果（如y）
	- 内存管理：在调用代码块Q时，如何管理Q所需的临时数据（如变量t和数组v）的存储空间，在结束Q后如何释放这些空间
- 所有的这些问题被定义在了应用二进制接口（Application Binary Interface，ABI）中
	- ABI定义了程序在机器级别上如何调用和返回函数，包括参数传递、返回值处理、寄存器使用约定、栈帧布局等
	- 不同的操作系统和编译器可能有不同的ABI规范
# 运行时栈的结构
- x86-64中的运行时栈：
	- 内存被视为一维的字节数组，地址从0开始递增x86-64系统使用栈结构管理内存
	- 不同的地址区域被分配给不同的用途，如代码段、数据段、堆和栈等![[Pasted image 20251020144907.png]]
	- 栈区域通常位于内存的**高地址部分**，并**向低地址增长**，由通用寄存器中的`%rsp`（栈指针寄存器）指向当前栈顶![[Pasted image 20251020144732.png]]