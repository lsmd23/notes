# 网络安全概述
- 核心目标：
	- 机密性（Confidentiality）：仅发送方和接收方可以理解消息内容，因此，需要发送方加密，接收方解密
	- 认证（Authentication）：发送方和接收方彼此确认对方身份
	- 消息完整性（Message Integrity）：确保消息在传输过程中未被篡改且可以被验证
	- 访问与可用性（Access and Availability）：确保合法用户能够访问网络资源，防止拒绝服务攻击等威胁
- 实例：对一个发送方，和一个接收方，入侵者可能实施的威胁行为有：
	- 窃听并拦截消息
	- 主动插入消息
	- 伪装数据包地址
	- 劫持、接管连接
	- 拒绝服务攻击
# 密码学原理
- 基本概念：
	- 定义：
		- $m$：明文消息
		- $K_A, K_B$：发送方A和接收方B的密钥
		- $K_A(m))$：使用A的密钥对消息$m$进行加密后得到的密文
		- $K_B(K_A(m))=m$：使用B的密钥对密文进行解密后得到的明文
	- 攻击方式：
		- 唯密文攻击（Ciphertext-only attack）：攻击者只能获取密文分析，需要遍历密钥破解加密算法
		- 已知明文攻击（Known-plaintext attack）：攻击者拥有一些明文和对应密文，可以利用这些信息推断密钥
		- 选择明文攻击（Chosen-plaintext attack）：攻击者可以选择明文并获取对应密文，进一步分析加密算法
## 对称密钥密码
- 特点：发送方和接收方共享同一密钥进行加密和解密，加密算法公开
	- $m\rightarrow K_S(m) \rightarrow K_S(K_S(m))$
- 分类：
	- 流密码（Stream Cipher）：逐位加密的方法
	- 块密码（Block Cipher）：将数据分成固定大小的块进行加密的方法
- 流密码：
	- 示意图：![[Pasted image 20251203163839.png]]
	- 工作机制：
		1. 密钥流生成：输入密钥，通过密钥流生成器生成伪随机的密钥流（keystream）
		2. 加密过程：将明文与密钥流逐位进行异或（$\oplus$）运算，生成密文
		3. 解密过程：利用异或运算的可逆性，将密文与相同的密钥流逐位进行异或运算，恢复明文
		4. 数学表示：
			- $m(i)$：明文的第$i$位
			- $ks(i)$：密钥流的第$i$位
			- $c(i)$：密文的第$i$位
			- 加密：$c(i) = m(i) \oplus ks(i)$
			- 解密：$m(i) = c(i) \oplus ks(i)$
	- 常用算法：RC4流密码
		- 密钥长度灵活，可以在1-256位之间选择
		- 曾用于802.11的WEP协议和SSL协议
- 块密码：
	- 工作机制：将明文按固定长度分成块，并转化成等长的密文块
		- 例：![[Pasted image 20251203164357.png]]
	- 块密码的映射：
		- 当块大小为$n$位时，有$2^n$种可能的输入块和输出块，对应的映射数量为$(2^n)!$
		- 当$n$很小时，暴力破解是可行的；但当$n$稍大时，映射数量会迅速增大，导致无法以表的形式存储，加密本身也变得复杂
	- 轮函数模拟法：解决块密码映射复杂性问题
		- 流程示意：![[Pasted image 20251203164752.png]]
			- 将输入拆分成8个8位的块
			- 每个块经过$S$盒替换
			- 替换后数据重组位64位结果，再置换到不同位置
			- 重复多轮处理，最终输出64位密文块
		- 作用：多轮的迭代和替换增加了加密的复杂性和安全性，使之可以以尽可能高的效率实现强加密
			- 轮数越多，计算成本越高，但安全性也越强
		- 问题：对同一个明文块，会输出相同的密文块，容易被攻击者利用；因此需要进行一些随机化处理，保证密文的多样性
	- 密码块链接（Cipher Block Chaining, CBC）模式：
		- 工作原理：
			- 为每个块生成一个随机数$r(i)$
			- 加密时使用前一块密文与明文块进行异或运算，再进行加密：$c(i) = K_S(m(i) \oplus c(i-1)$
			- 解密时，利用前一块密文与解密后的密文块进行异或运算恢复明文：$m(i) = K_S(c(i)) \oplus c(i-1)$
			- 初始块使用一个随机初始化向量（IV）$r(0)$代替前一块密文，无需保密
		- 效果示意：![[Pasted image 20251203165629.png]]保证相同明文不会产生相同密文
	- 常用算法：
		- DES算法（Data Encryption Standard）：
			- 特点：块大小64位，密钥长度56位，使用CBC模式
			- 在1天内被破解，现在常使用改进后的3DES算法提升安全性
			- 流程：
				- 初始置换 $\rightarrow$ 16轮迭代，每轮用密钥的48位子密钥进行加密 $\rightarrow$ 最终置换
				- 每轮将数据分为两部分，通过轮函数混淆扩散
				- 示意图：![[Pasted image 20251203165950.png]]
		- AES算法（Advanced Encryption Standard）：
			- 特点：块大小128位，密钥长度128、192或256位
			- 采用多轮替换和置换，安全性高且效率较高（几乎不可能被暴力破解）
			- 目前被广泛应用于HTTPS等安全协议中
## 公钥密码
- 特点：使用一组公钥和私钥进行加密和解密，公钥公开，私钥保密
	- 示意图：![[Pasted image 20251203171004.png]]
	- 使用公钥$K_B^+$加密消息$m$，得到密文$c$：$c = K_B^+(m)$；再使用私钥$K_B^-$解密密文$c$，恢复明文$m$：$m = K_B^-(K_B^+(m))$
	- 要求知晓公钥的人无法通过公钥推导出私钥