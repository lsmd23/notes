# 概率主题模型
## 迪利克雷-多项分布模型
- 问题：文本的内容分类
- 贝塔-伯努利模型：
	- 贝塔分布：![[Pasted image 20250519162711.png]]
		- 是伯努利分布的一种后验估计分布
	- 统计模型中，将其用于伯努利分布的先验分布，也即数据的产生过程为：![[Pasted image 20250519163107.png]]
- 迪利克雷-多项模型：
	- 多项分布与类别分布：
		- 在多项分布中令试验次数为1，得到的分布为类别分布（也称多伯努利分布）
	- 迪利克雷分布：贝塔分布在多维上的扩展$$p(\theta|\pmb\alpha)=\frac{1}{B(\pmb\alpha)}\prod_{k=1}^K\theta_k^{\alpha_k-1},$$
	- 过程：![[Pasted image 20250519163912.png]]
- 迪利克雷-多项混合模型：
	- 同一组分布可以生成多组数据，同时也有多个组合起来的分布
	- 生成过程：![[Pasted image 20250519164150.png]]其中，$\theta$应为$K$维的（也即主题的个数），$\beta_k$则应为$V$维的（也即词表的大小）
## 隐迪利克雷分配
- 超混合模型：同一数据集也不单单只来自一个分布，而是以一定比例来自不同的分布
	- 建模超混合模型：![[Pasted image 20250519164601.png]]也即隐迪利克雷分配模型
	- 概率图表示：![[Pasted image 20250519165040.png]]对应的，参数、隐变量和可观测变量如下：![[Pasted image 20250519165650.png]]
	- 例：生成式文本模型：
		- 先从迪利克雷分布获取主题与词表：![[Pasted image 20250526153204.png]]
		- 再根据取样得到的词表对应的多项分布生成文本：![[Pasted image 20250526153216.png]]
# 变分推断
## 平均场变分推断
- 似然函数：
	- 思想：认为隐变量是可观测的，进而写出被完全观测的对数似然函数：$$\log p()$$其中每个条件概率都是被定义过的（迪利克雷分布或多项分布），代入：$$\log p()$$
- 隐变量的解决：[[L10 推理(B)#期望最大化算法|EM算法]]
	- E步：用变分方法，找到一个函数代替隐变量的后验分布（KL散度）
		- 问题：此处建模的模型中，即使计算E步的条件概率也是NP难的问题
		- 解决：继续使用变分方法，用变分函数近似KL散度，从而使用梯度的优化方法解决问题
	- 平均场论模型：类比物理学中的平均场论，变分函数可以被因子分解，推导可得，每一个维度（因子）上的ELBO函数等于对其他维度的概率值进行积分
	- 思想：在简化概率图建模的情况下，引入变分参数，通过对变分参数的迭代优化，从而尽可能模拟原来的分布
## LDA模型的变分推断
- 建模：用LDA的思想建模变分分布
	- 示意图：![[Pasted image 20250526161558.png]]公式：$$q()$$
- 推断：
	- 上述建模成功实现了对变分分布的因子分解
	- 因此，只需采用平均场论的思想，对其他变量积分，就可以对单个的变分参数进行计算，进而进行参数的学习：$$L=\sum_{k=1}^K$$
		- 例：计算第二项：
	- 求导推得其最大似然估计：且这个最大似然估计是符合实际的直观解释的
## LDA模型的参数估计
- 得到变分分布，代入变分分布用梯度方法即可进行模型参数的学习
# 变分自编码机
- 
