# 概率推理
- 对实际问题的建模：
	- 概率建模：建模一个高维的**联合概率分布函数**
	- 推理：给定条件，返回某变量的一个概率分布（也即求**条件概率分布**）
	- 形式化：给定一组随机变量$X=\{x_1,\cdots,x_D\}$，将其划分为“询问”集$R$（也即信息集）与条件集$C$
		- 建模问题：贝叶斯网络与马尔可夫随机过程
		- 方法：变量消除——[[#^41e6aa|变量消除算法]]、隐变量模型、变分方法、采样方法
# 图模型建模
## 贝叶斯网络
- 概率的乘法公式：$$p(x_1,\cdots,x_K)=p(x_K|x_1,\cdots,x_{K-1})$$
- 将等式右边相互依赖的一系列条件概率函数，建模为图的节点，图之间的边表示变量之间的条件依赖关系，则得到一个有向无环图(DAG)，则公式为：$$p(x_1,\cdots,x_K)=\prod_{s=1}^Kp(x_s|\pmb x_{\Gamma(s)})$$
- 例：实际问题
	- 问题：![[Pasted image 20250510153740.png]]
	- 建模：![[Pasted image 20250510153752.png]]
	- 引入参数，即先验概率：![[Pasted image 20250510154023.png]]进而，可以根据这一模型，得出任意节点对应的概率（使用贝叶斯公式）
- 例：机器学习的多项回归模型
	- 建模：![[Pasted image 20250510155052.png]]
	- 解释：
		- 回归模型中，参数$\pmb w$依赖一个先验（对应于正则化）$\alpha$，对给定的样本数据$x_n$，输出观测值$t_n$依赖于方差$\sigma^2$与回归参数$\pmb w$，预测值依赖于待估计的样本$\hat x$、方差$\sigma^2$与回归参数$\pmb w$
		- 待推断的变量，即为隐变量，对应于学习中的参数；可观测的变量对应于数据集合；决定变量对应于损失函数
## 马尔可夫随机场
- 实际问题中，贝叶斯网络建模出的有向无环图难以表示一些问题，需要引入无向边表示实际问题
- 例：投票问题
	- 定义势函数，用于刻画有相关性的不同变量之间的相关程度大小![[Pasted image 20250510160054.png]]
- 马尔可夫随机场：
	- 建模：一个无向图，节点为变量，在团（连通分量）上定义势函数
	- 联合概率函数：$$p(\pmb x)=\frac{1}{Z}\prod_C \psi_C(\pmb x_C)$$
		- $C$对应一个连通分量
		- $\pmb x$表示一个变量集合
		- $\psi$表示一个连通分量上的势函数
		- $Z$为归一化常数
	- 能量函数：定义$$\psi_C(\pmb x_C)=\exp\{-E(\pmb x_C)\}$$则联合概率函数和能量函数之间构成连加关系$$p(\pmb x)=\frac{1}{Z}\exp\{-\sum_C E(\pmb x_C)\}$$
- 例：图像去噪![[Pasted image 20250510161143.png]]
	- 建模：每个像素对应两个节点——原图的像素块$x_i$和噪声后的像素块$y_i$，存在$x_i$和四周的$x_j$之间的依赖和$x_i$到$y_i$的依赖![[Pasted image 20250510161501.png]]
	- 定义能量函数：$E(x_i,y_i)=-\eta x_iy_i$；$E(x_i,x_j)=-\beta x_ix_j$，则总的能量函数为：$E(\pmb{x,y})=-\eta\sum_ix_iy_i-\beta\sum_{\{i,j\}}x_ix_j$，联合概率分布为：$$p(\pmb x,\pmb y)=\frac{1}{Z}\exp\{-E(\pmb x,\pmb y)\}$$
	- 去噪过程即为求最大后验估计：$$\hat{\pmb x}=\arg\max_{\pmb x}p(\pmb x|\pmb y)$$
- 与贝叶斯网络的关系：
	- 贝叶斯过程的乘法公式无法分解条件式右侧的变量集合
	- 采用马尔科夫随机场的观点，将一组条件式右侧的变量集合视为一个连通分量（团），采用势函数描绘
	- 将一组条件概率也建模为一个团
	- 例：![[Pasted image 20250510162301.png]]
# 条件独立性
## D分离准则
- 独立性：
	- 两变量**边缘独立**，当且仅当$p_{XY}(x,y)=p_X(x)p_Y(y)$
	- 两变量**条件独立**，当且仅当$p_{XY|Z}(x,y|z)=p()p()$或$p_{X|YZ}(x|y,z)=p_{X|Z}(x|z)$
- 贝叶斯网络中的独立性：考虑三个节点的情况
	- 边缘独立：仅一种情况![[Pasted image 20250510164008.png]]
		- 解释：
	- 条件独立：
- D分离准则：
	- 在概率图模型上做判断
	- 判断节点之间是否“相通”：
		- 
	- 只要有一条路径使得两变量相通，则两变量不独立，否则其独立
- 马尔可夫边界：
	- 根据上述的D分离准则，可以在完全的条件概率函数中，约去相互独立的变量，简化变量的数目
	- ：
		- 
## 马尔可夫性质
- 应用于马尔可夫网络的独立性判断
# 图模型中的推理
## 变量消去

^41e6aa

- 边际推断：
- 最大后验推断：
- 变量消除算法：
	- 例：马尔科夫链推断
	- 算法实现：![[Pasted image 20250510170102.png]]
	- 例：![[Pasted image 20250510170431.png]]![[Pasted image 20250510170436.png]]![[Pasted image 20250510170442.png]]
	- 
## 