# 串匹配问题
- 问题描述与基本概念：
	- 在文本T[1..n]中找到模式P[1..m]的所有出现。如果$0 ≤ s ≤ n − m$且T[s + 1:s + m] = P[1:m]，则称模式P在文本T中以s位移出现
	- 定义字母表$\Sigma$与前后缀标记$⊏,⊐$：见[[形式语言与自动机/L0 绪论#形式语言基础|形式语言与自动机——形式语言基础]]
- 后缀重叠引理：对均为字符串$z$后缀的两字符串$x,y$，若$|x|\leq|y|$，则$x⊐y$；若$|x|\geq|y|$，则$y⊐x$；若$|x|=|y|$，则$x=y$
# 串匹配算法
## 暴力算法
- 实现：![[Pasted image 20250506083030.png]]
- 复杂度：$\Theta((n-m+1)m)$
## Rabin-Karp算法
- 思路：假定串定义在字母表$\Sigma = \{0,1,\cdots,9\}$上
	- 模式串P[1..m]对应一个十进制整数$p$，文本串的子串T[s+1..s+m]也对应一个十进制整数$t_s$，二者匹配的充要条件是$p=t_s$
	- 利用递归算法，可以在$\Theta(m)$时间内计算出$p$：$$p=P[m]+10(P[m-1]+10(P[m-2]+\cdots+10(P[2]+10P[1])\cdots))$$
	- 可以迭代的在$\Theta(n-m+1)$时间内计算出$t_s$：$$t_{s+1}=10(t_s+10^{m-1}T[s+1])+T[s+m+1]$$
- 改进：
## 自动机串匹配
- 有限自动机：
	- [[L1 确定有限自动机(DFA)#DFA的定义|确定有限自动机]]
	- [[L2 非确定有限自动机(NFA)#NFA的定义|非确定有限自动机]]
- 串匹配自动机：
	- 定义一个自动机，其状态集合取决于模式串的长度：$Q=\{0,1,\cdots,m\}$，初态为$0$，唯一接受终态为$m$
	- 定义模式串P的**后缀函数**：$\sigma(x)=\max\{k:P[:k]⊐x\}$，即P中完全作为x的后缀的最大位置
		- 例：$P = ab, σ(ε) = 0, σ(ccaca) = 1, σ(ccab) = 2$
		- $\sigma(x)=m\Leftrightarrow P⊐x$
	- 定义转移函数：$\delta(q,a)=\sigma(P[:q]a)$
		- 例：![[Pasted image 20250506085613.png]]![[Pasted image 20250506085622.png]]
- 串匹配自动机算法：
	- 实现：对每个位置运行自动机即可![[Pasted image 20250506085917.png]]
	- 正确性证明：
		- 引理：（后缀函数不等式）对任意串$x$与字符$a$，有$\sigma(xa)\leq\sigma(x)+1$
		- 引理：（后缀函数递归引理）对任意串$x$与字符$a$，若$q=\sigma(x)$，则$\sigma(xa)=\sigma(P[:q]a)$