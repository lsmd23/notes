# 道路与回路的概念
- 道路与回路：
	- 定义：给定图$G = <V, E>$(无向或有向的)，$G$中顶点与边的交替序列：$P = v_0e_1v_1e_2…e_lv_l$。若$\forall i (1 \leq i \leq l), e_i = (v_{i−1}, v_i)$，则称$P$为$v_0$到$v_l$的**通路（道路）**, $v_0$和$v_l$分别为通路的**起点和终点**，$l$为通路的长度
		- 若$v_0 = v_l$，则称$P$为**回路**，也称**圈**
		- 长度为奇数的圈称作**奇圈**，长度为偶数的圈称作**偶圈**
		- 说明：
			- 可简约到边序列或顶点序列
			- 无向简单图中，圈的长度至少为3；有向简单图中，圈的长度至少为2
	- 定义：若通路（回路）中**所有边各异**，则称为**简单通路（简单回路）**，否则称为复杂通路（复杂回路）；若简单通路（回路）中所有**顶点（对于回路，除$v_0=v_l$）各异**，则称为**初级通路或路径（初级回路或圈）**
		- 显然：初级通路（回路）是简单通路（回路）
	- 定理：在无向图$G= (V, E)$中，若任意$v\in V$有$\deg(v) \geq 2$，则$G$中存在圈
- 图的连通性：
	- 连通：设无向图$G=<V,E>$，$u,v\in V$，若$u$与$v$之间有通路，则称其连通，称$u$到$v$是**可达的**
	- 连通图：任意两点都连通的图为连通图。否则为非连通图
		- 对于**有向图**，若**不考虑其边的方向**，即视之为无向图，若它是连通的，则称$G$是连通图，也即**弱连通的**
		- 有向图中任意两点相互可达，则称其为强连通的，任意点强连通的图即为**强连通图**
	- 短程线与距离：
		- 短程线：$u$与$v$之间长度最短的通路，不可达时记为$\infty$
		- 距离：$u$与$v$之间短程线的长度，记为$d(u,v)$
			- $d(u,v)\geq 0$，等号当且仅当$u=v$时取得
			- $d(u,v)=d(v,u)$
			- 三角不等式：$d(u,v)+d(v,w)\geq d(u,w)$
		- 有向图中的短程线与距离：类似，但有向图中的距离不具有对称性
	- 连通支：若连通子图$H$不是$G$的任何连通子图的真子图，称$H$是$G$的**极大连通子图**，或**连通支**
- 连通度：
	- 割点和割边：
		- $v$是$G$中的一个顶点，若$G − v$的连通分支数比$G$多，就称$v$是$G$的一个**割点**
		- $e$是$G$中的一条边，若$G − e$的连通分支数比$G$多，就称$e$是$G$的一条**割边**
	- 割点的性质：以下性质等价
		1. $v$是$G$的一个割点
		2. 存在与$v$不同的两个顶点$u$和$w$，使得任一条$u$到$w$的道路$P_{uw}$都经过$v$
		3. 图$V-v$可以划分为两个顶点集$U$和$W$，使得对任意顶点$u\in U$和$w ∈ W$，顶点$v$都在每条道路$P_{uw}$上
	- 割边的性质：以下性质等价
		1. 边$e$是$G$的一条割边
		2. 边$e$不属于$G$的任何回路
		3. 存在$G$的顶点$u$和$w$，使$e$属于$u$和$w$的任何一条道路$P_{uw}$
		4. 图$G − e$可以划分为两个顶点集$U$和$W$，使得对任意顶点$u ∈ U$和$w ∈ W$ ，道路$P_{uw}$都经过$e$
	- 点割集：令$G = <V, E>$是无向图，节点集合$V_1$，$V_1\subseteq V$，如果删去$V_1$中**所有节点和对应边后，$G$的连通分支数会增加**，而删去$V_1$的**任何真子集中的所有节点，连通分支数量不会增加**。则称$V_1$是$G$的一个点割集
		- ![[Pasted image 20250611170911.png]]
	- 点断集：令$G = <V, E>$是连通无向图且至少包含2个节点，节点集合$V_1$，$V_1\subseteq V$，如果**删去$V_1$中所有节点以及对应的边后**，G就变得**不连通**或者**只剩一个孤立节点**，称$V_1$是$G$的一个点断集
		- ![[Pasted image 20250611171022.png]]
	- 边割集：令$G = <V, E>$是无向图，边集合$E_1$，$E_1\subseteq E$，如果删去$E_1$中**所有边后，$G$的连通分支数会增加**，而删去$V_1$的**任何真子集中的所有边，连通分支数量不会增加**。则称$E_1$是$G$的一个边割集
		- ![[Pasted image 20250611171222.png]]
	- 边断集：令$G = <V, E>$是连通无向图且至少包含2个节点，边集合$E_1$，$E_1\subseteq E$，如果**删去$E_1$中所有的边后**，G就变得**不连通**，称$E_1$是$G$的一个点断集
		- ![[Pasted image 20250611171228.png]]
	- 点连通度：$𝜿(G) = \min\{ | V_1| | V_1是G的点断集\}$ 为$G$的点连通度
		- 表示使图不连通或只剩一个孤立节点至少要删去的节点数
		- 有割点的连通图的点连通度为1，不连通图的连通度为0，完全图的连通度为$n-1$
	- 边连通度：若$G$至少有两个节点，定义：$λ(G) = \min\{|E_1||E_1是G的边断集\}$为图$G$的边连通度
		- 表示使图不连通至少要删去的边数
		- 不连通图的边连通度为0，完全图的边连通度为$n-1$
	- 定理：**连通图$G$中，有$𝜿 (G) ≤ λ(G) ≤ δ(G)$，其中$δ(G)$是顶点的最小度**
		- 证明：略
	- 定理：简单连通图$G$中，有$𝜿 (G) ≤\lceil \frac{2m}{n}\rceil$
		- 证明：![[Pasted image 20250611171812.png]]
	- 块：图$G$中**极大的没有割点的连通子图**称为块
		- 性质：以下性质等价：
			1. $G$是一个块
			2. $G$的任何两个顶点同属某一初级回路
			3. $G$的任何一个顶点和任何一条边同属某个初级回路
			4. $G$的任何两条边同属某个初级回路
			5. 给定两个点$u, v$和一条边$e$，存在一条包含$e$的初级道路$P_{uv}$
			6. 对$G$的任意三个不同的顶点，存在一条包含它们的初级道路
			7. 对$G$的任意三个不同的顶点，存在一条只包含其中两点而不含第三点的道路
# 道路与回路的判定
- Warshall算法：
	- 邻接矩阵的性质：[[Chapter 1 图的基本概念#^e1539d|邻接矩阵与路径的关系]]
	- 由此，可得基于邻接矩阵的代数解法：设$A$是图$G$的邻接矩阵, 则$A^l$中$(i, j)$位置元素为从节点$v_i$到$v_j$长度为$l(l\geq1)$的路的数目
	- 可达矩阵：表示图中任意两个节点间的可达关系。$\forall G= (V, E)$对节点编号$V= \{v_1, v_2, …, v_n\}$，可达矩阵为$P(G)=(p_{ij})_{n\times n}=A+A^2+\cdots+A^n$
		- 若$p_{ij}\geq1$，则两点之间可达，否则不可达
	- Warshall算法：
		- 描述：![[Pasted image 20250611172828.png]]
		- 复杂度：三重循环为$O(n^3)$
		- 定理：Warshall算法的结果是图$G$的道路矩阵
		- 最短路的算法：见[[|最短路径——Floyd算法]]
- 搜索法：
	- 广度优先搜索：参考[[L10 图#^ce26eb|数据结构——图的广度优先搜索]]
	- 深度优先搜索：参考[[L10 图#^04bcbf|数据结构——图的深度优先搜索]]
# 欧拉道路与回路
- 基本概念：
	- 欧拉通路：经过所有顶点，且**每条边恰好经过一次的通路**
	- 欧拉回路：经过所有顶点，且**每条边恰好经过一次的回路**
	- 欧拉图：有欧拉回路的图
	- 半欧拉图：有欧拉通路而无欧拉回路的图
- 无向图的欧拉道路与回路：
	- 定理：无向连通图$G$有**欧拉回路**的充要条件是**各顶点的度都是偶数**
		- 证明：![[Pasted image 20250611162613.png]]![[Pasted image 20250611162616.png]]![[Pasted image 20250611162621.png]]
	- 欧拉回路的构造：
		1. 任选节点，找简单回路$E_1$
		2. 删去该回路对应的边，在新图中，找新的简单回路$E_2$，使$E_1$与$E_2$至少有一个公共点
		3. 加入回路$E_2$，反复迭代直至图中没有边
	- 推论：若无向连通图$G$中**只有两个奇顶点**，则$G$存在**欧拉道路**
		- 欧拉道路的构造类似
	- 定理：设连通图中有$K$个度为奇数的顶点，则$E(G)$可以划分成$\frac{K}{2}$条简单道路
		- 也即k笔画问题
		- 证明：![[Pasted image 20250611162949.png]]
		- 推论：设图$G$是连通的，并且恰有$2k$个奇点，那么图形$G$可用$k$笔不重复画成，并且至少要用$k$笔画成
- 有向图的欧拉道路与回路：
	- 若有向连通图$G$中各个节点的**正负度相等**，则$G$中存在**有向欧拉回路**
	- 若有向连通图$G$中只有两个节点的正负度不相等，而且**其中一个入度比出度多$1$，另一个入度比出度少$1$**，则$G$中存在**有向欧拉通路**
# 哈密顿道路与回路
- 基本概念：
	- 哈密顿通路：连通图的一条经过所有顶点一次且仅一次的通路，简记为$H$-通路
	- 哈密顿回路：连通图中经过所有顶点一次且仅一次的回路，简记$H$-回路
	- 哈密顿图：具有哈密顿回路的图
	- 半哈密顿图：具有哈密顿通路的图
	- 注：环与重边不影响图的哈密顿性，故只考虑简单图
- 哈密顿回路的必要条件：
	- 简单的必要条件：
		- 带有1度顶点的图没有哈密顿回路
		- 若图中有2度顶点，则关联这个顶点两条边属于任何哈密顿回路
		- 每个顶点只能有两条关联的边在哈密顿回路内
		- 哈密顿回路不能包含更小的回路
		- 至少有3个点的完全图是哈密顿图
	- 定理：若图$G = <V, E>$有$H$回路，则对$V$的任何非空子集$S$，均有$p(G -S) ≤ |S|$，其中$p(G -S)$是从$G$中删去$S$中所有节点及与这些节点关联的边所得到的子图的连通分支数
		- 证明：![[Pasted image 20250611164108.png]]
	- 推论：若图$G = <V, E>$有$H$道路，则对$V$的任何非空子集$S$，均有$p(G -S) ≤ |S|+1$
	- 推论：有割点的图不是哈密顿图
	- 推论：若图$G= <V_1, V_2, E>$为二分图且有哈密顿回路，则$|V_1| = |V_2|$
- 哈密顿回路的充分条件：
	- 定理：若简单图$G$中任两点$u, v$，恒有$d(u)+ d(v)≥ n -1$，则$G$中存在哈密顿道路
		- 证明：![[Pasted image 20250611165148.png]]![[Pasted image 20250611165153.png]]![[Pasted image 20250611165158.png]]
	- 推论：若简单图$G$中任两点$u, v$，恒有$d(u) + d(v) ≥ n$，则$G$中存在哈密顿回路
	- Dirac定理：若简单图$G$中每个节点的度都大于等于$\frac{n}{2}$，则$G$中存在哈密顿回路
- 哈密顿回路的判定：
	- 引理：简单图$G$中$v_i$和$v_j$是不相邻节点，满足$d(v_i)+d(v_j)≥n$，则$G$存在$H$回路的充要条件是$G+(v_i, v_j)$有$H$回路
	- 闭合图：若$v_i$和$v_j$是简单图$G$的不相邻节点，满足$d(v_i) + d(v_j) ≥ n$，则令$G' = G + (v_i, v_j)$，对$G'$重复上述过程，直到不再有这样的节点对。最终得到的图称为$G$的闭合图，记为$C(G)$
		- 引理：简单图的闭合图唯一
	- 定理：简单图$G$存在哈密顿回路的**充要条件**是其闭合图存在哈密顿回路
		- 推论：若简单图$G(n>2)$的闭合图是完全图，则$G$有哈密顿回路
# 旅行商问题
- 问题：给定正权的完全图，求其总长最短的哈密顿回路
	- 和哈密顿回路一样是NPC问题
- 分支定界法：
	- 枚举搜索的剪枝方法
	- 算法：按边枚举
		1. 首先将边权由小至大排序，初始界$d_0←\infty$
		2. 在边权序列中依次选边进行深探，直至选取$n$条边，判断是否构成$H$回路（每个顶点标号只出现2次，且这些边只构成一个回路)，若是，$d_0←d(s_1)$，结束
		3. 依次删除当前中的最长边，加入后面第一条待选边，进行深探，如果它是$H$回路且$d(s)<d_0$，则$d_0←d(s)$作为界
		4. 不能再深探时需要退栈。如果栈空，结束，其最佳值为$d_0$。否则如果新分支的 $d(s_i)>d_0$, 继续退栈；若$d(s_i)<d_-0$, 转3
		- 例：![[Pasted image 20250611190718.png]]![[Pasted image 20250611190725.png]]
- 近似算法——便宜算法：
	- 采用贪心的策略
	- 算法步骤：
		1. 设 $w (i , j )$ 为边权值，对任意 $i$，$w( i , i ) = 0$。置$S = \{2, 3, .., n\}$，序列 $T = (1,1)$
		2. 在 $S$ 中，令$(j,t)=\arg\min_{i\in S,k\in T}w(i,k)$，即 $j∈S, t∈T$，对回路$T$中的边$(t , t_ 1 ), (t , t_ 2 )$，如果$w (j , t ) + w (j , t_ 1 )- w (t , t_ 1 )\leq w (j , t ) + w (j , t_ 2 ) -w (t , t_ 2 )$，则$j$插到$t$与$t_1$之间，否则$j$插到$t$与$t_2$之间
		3. 令$S=S -\{j\}$，若此时 $S = \emptyset$ 则结束，否则转2
		- 例：![[Pasted image 20250611191158.png]]
# 最短路径
- 求带权图点之间的最短道路
- Dijkstra算法：
	- 求解边权为正的某点到其他点的最短路径
	- 引理：正权图中任一条最短路径长度大于其局部路径长度
	- 引理：正权图中若 $P_i$ 是$v_ 1$到$v _i$的最短路，且$v _j \in P_ i$，则$P_ j$也是$v_ 1$到$v_ j$的最短路
	- 算法描述：是贪心的算法
		1. 初始化：集合 $P$ 中只有顶点 $v_1$，$π (v _1)$ 为0 ，集合$T = V-P$中顶点 $v _i$ 的距离值为边 $(v _1 , v_ i ) (i =2, … , n)$ 的权 $w_ {1 i}$，如果$v_ 1$和$v_i$间无边直接相连，则$π (i)$为$\infty$
		2. 贪心选择：在集合 $T$ 中选择**距离值 $π$ 最小的顶点** $j$ 加入集合 $P$，$P = P + \{j\} ,T = T-\{ j\}$
		3. 修正：对集合 $T$ 中 $j$ 的后继节点 $i$ 的距离值进行修正：如果加入顶点 $j$ 后，使 $v _1$ 到 $v_ i$ 的距离值比原来的距离值更小，则修改 $v_ i$ 的距离值 $π (i ) = \min (π (i ), π (j ) + w _{ji})$
		4. 重复2 和 3 ，直到 $T$ 为空为止
		- 例：![[Pasted image 20250611191931.png]]
	- 边权值均为1时，退化为BFS算法
- Ford算法：
	- 求解无负权回路的图中的最短路径
	- 算法：
		1. 赋初值$\pi (1) = 0 ,\pi (i ) = \infty,i = 2, 3, … , n$
		2. 更新 $\pi( i ), i = 2, 3, … , n$：$\pi (i ) = \min \{ \pi (i), \min \{\pi(j)+w_{ji}|j\in i的直接前驱集\} \}$
		3. 若所有的$\pi(i)$都无变化，停止，否则继续迭代
		- 算法复杂度为$O(mn)$，负长回路时算法不终止
		- 实际计算时，选用Dijkstra算法的结果为迭代初值，可以更快的收敛
		- 例：![[Pasted image 20250611192454.png]]
- Floyd算法：逐个节点试探法
	- 算法：设$A = (a _{ij}) _{n × n}$为赋权图 $G = (V , E , F)$ 的权矩阵，$d_{ij}$表示从 $v_ i$到 $v_ j$点的距离
		1. 赋初值：对所有$i , j$，$d _{ij} = a_ {ij},k = 1$
		2. 更新$d _{ij}$：对所有$i , j$，若$d _{ik}+ d _{kj}< d_{ ij}$，则令$d_{ ij}d _{ik}+ d _{kj}$
		3. 终止判断：若$k = n$终止；否则令$k= k + 1$，继续迭代
		- 例：见[[L10 图#^bd40a1|s数据结构——Floyd算法]]
# 关键路径
- 解决相互依赖工序的完成时间问题
- 建模：
	- PT图：以节点表示工序，若工序$j$依赖工序$i$的完成，则添加有向边$(v_i,v_j)$，权值$w_i$为工序$i$所需时间
		- 为求解关键路径，常增加一个超发点和超收点，权值记为0
		* 这是一个有向无环图
	* PERT图：节点建模为工序之间的关系：$v_k$是$e_i$的终点、$e_j$的始点表示工序$e_i$完成后$e_j$才能开始
		* 用有向边表示工序
		* 边权 $w_i$ 表示该工序所需时间
* 拓扑排序：
	* 引理：若有向图 $G$ 无有向回路 ，则一定存在入度为0的点及出度为0的点
	* 定理：拓扑序存在：若有向图 $G$ 无有向回路，则可以将 $G$ 的节点重新编号为$v_1', v_2', … , v_n'$使得对任意的边$v_i 'v_j' \in E (G )$，都有 $i<j$ ，这一顺序记为拓扑序
	* 算法：
		1. 从有向图中选择一个没有前驱（即入度为0）的顶点并且输出它
		2. 从图中删去该顶点，并且删去从该顶点发出的全部有向边
		3. 重复上述两步，直到剩余的图中不再存在没有前驱的顶点为止
		4. 如果还有顶点却没有入度为0的顶点 ，说明有向图有环存在
- 关键路径：
	- 算法：
		1. 对节点做拓扑排序
		2. 赋初值 $\pi( v_1') = 0$
		3. 依次更新 $\pi(v_j'), j = 2, 3, … , n$：$$\pi(v_j')=\max_{v_i'\in \Gamma^-(v_j')}(\pi(v_i')+w(v_i',v_j'))$$也即寻找前趋中的最大者
		* 算法复杂度为$O(m)$，得到的是最早启动时间
		* 例：![[Pasted image 20250611184406.png]]
	* 最晚启动时间算法：
		1. 对节点做拓扑排序
		2. 赋初值 $\tau( v_n') = \pi(v_n')$
		3. 依次更新 $\tau(v_j'), j = n-1, n-2, … , 1$：$$\tau(v_j')=\min_{v_i'\in \Gamma^+(v_j')}(\tau(v_i')-w(v_i',v_j'))$$也即寻找后继中的最小者
		4. $\tau(v_i')-\pi(v_i')$即为工序的允许延误时间
# 中国邮路问题
- 求解带权图的过每条边至少一次的最短回路问题
	- 转化为欧拉回路问题：在原图中重复某些边使得新图为欧拉图，且欧拉回路的长度最小
- 中国邮路问题：
	- 平凡解：
		- 对欧拉图和半欧拉图，欧拉道路/回路就是中国邮路问题的解
		- 对只有一个点度数为奇数是，不存在回路，无解
	- 定理：$L$ 是无向连通图 $G$ 最佳邮路的充要条件是：$G$ 的每条边最多重复一次，且在 $G$ 的**任意一个回路上，重复边的长度之和不超过该回路长度的一半**
		- 证明：![[Pasted image 20250611185102.png]]![[Pasted image 20250611185106.png]]![[Pasted image 20250611185114.png]]![[Pasted image 20250611185119.png]]
	- 构造中国邮路算法：
		1. 找出度为奇的点
		2. 构造邮路，使得 $G$ 的每条边最多重复一次，并保证计算重复边之后度都是偶数
		3. 对所有回路进行判断，在 $G$ 的任意一个回路上如果重复边的长度之和超过该回路长度的一半， 则**令回路中的重复边不重复，不重复边变为重复**
		- 例：![[Pasted image 20250611185316.png]]
		- 另：最小权匹配算法
			1. 确定 $G$ 中度为奇的节点，构成 $V_0 (G)$
			2. 求$V_0 (G)$各节点在 $G$ 中的最短路径 $P_ {ij}$及其长度 $π( v _i , v _j)$
			3. 对$V_0 (G)$的节点进行最小权匹配，即选出$\frac{|V_0 (G)|}{2}$个$π (v_i,v_j )$，保证每个节点在中只出现一次，并且这些$π (v_i,v_j )$的总和最小（[[Chapter 6 匹配#*最佳匹配*|最佳匹配问题]]） 
			4. 在最小权匹配里各$π (v_i,v_j )$所对应的路径$P_{ij}$中的各边在$G$中重复一次，得到 $G'$
			5. $G'$ 是欧拉图，它的一条欧拉回路即为解
	- 有向图的中国邮路
		- 构造算法：
			1. 计算各点的正负度，求出$d'(v_i)=d^-(v_i)-d^+(v_i)$
			2. 添加一个超发点$v_s$，对满足$d (v_i)> 0$的节点，加入$d(v_i)$ 条有向边$(v_s , v_i)$，权为0
			3. 添加一个超收点$v_t$，对满足$d (v_j)< 0$的节点，加入$d(v_j)$ 条有向边$(v_j , v_t)$，权为0，得到图$G'$
			4. 在 $G$ 中求 $d (v_s)$ 条过以 $v_ s , v_ t$为两端点的形如 $(v_s , v _i ),...,(v _j ,v _t )$，每边一次且仅一次的总和最小的 $P_{st}$ 道路。记下 $G$ 中各边在这些道路里的重复次数
			5. 计入各边的重复次数， $G$ 中存在有向欧拉回路，其中一条即为解