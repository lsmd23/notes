# 树的基本概念
- 定义：**不含回路的图**称为林，若林是**连通的**，称为树，其边称为树枝，度为1的点为叶子节点，其他节点则为分支节点（内节点）
- 等价命题：$G= <V, E>$是$n$阶$m$条边的无向图
	1. $G$是树（连通且无回路）
	2. $G$中任意两个顶点之间存在唯一的路径
	3. $G$中无回路，且$m= n -1$
	4. $G$是连通的，且$m= n -1$
	5. $G$是连通的，且$G$中任何边均为桥
	6. $G$中没有回路，但在任何两个不同的顶点之间加一条新边，在所得图中得到唯一一个含新边的回路
- 支撑树：设树$T$是无向图$G$的子图，则称$T$为$G$的树；若树$T$是$G$的**支撑子图**，则称$T$是$G$的**支撑树**；设$T$是$G$的支撑树，$\forall e \in E(G)$，若$e \in E(T)$，则称$e$为$T$的**树枝**，否则，称$e$为$T$的**弦**；称子图$G[E(G) -E(T)]$为$G$关于$T$的**余树**
	- 注：余树并不是树
	- 支撑树的生成：
		- 破圈法：每次去掉回路中的一条边，去掉边的总数为$m –n + 1$，计算效率低
		- 避圈法：每次选取$G$中一条与已选取的边不构成回路的边，增加的边的总数为$n -1$，一般用深度优先或广度优先搜索来实现
			- DFS：
				1. 任选图中的一个节点作根
				2. 通过相继地增加边来形成从这个顶点开始的通路，其中每条新边都和通路上的最后一个节点以及还不在通路上的节点关联
				3. 若这条通路经过图中的所有节点，则为支撑树，否则还必须增加新边：从通路上倒退一个节点，若有可能，形成这个节点开始的尚未访问过的节点的通路；否则再倒退一个节点；
				4. 重复这个过程，从访问过的最后一个节点开始，在通路上一次后退一个节点，只要有可能就形成新的通路，直到不能增加新边为止。
			- BFS：
				1. 任选图中的一个节点作根；
				2. 添加与这个节点相关联的所有边，形成支撑树中在一层的所有节点，任意对这些新节点排序；
				3. 按顺序访问一层上的每个节点，只要不产生简单回路，就将与这个节点关联的每条边添加到树中，这样就产生了树在二层上的节点；
				4. 重复这个过程，直到已经添加了图中所有的节点为止
# 基本关联矩阵
- 线性代数基本概念：
	- 线性相关与无关
	- 矩阵的初等变换
	- 矩阵的行秩与列秩
	- 矩阵的行列式
	- 代数余子式
- 关联矩阵及其性质：
	- 定理：有向图$G = (V, E)$关联矩阵$B$的秩$\text{rank}(B)< n$，也即**关联矩阵的行是线性相关的**
		- 证明：![[Pasted image 20250611151541.png]]
	- 引理：设$B$为有向连通图$G$的关联矩阵，$C$是$G$中的一个**回路**，则$C$中各边所对应$B$的各**列相关**
		- 证明：![[Pasted image 20250611151547.png]]
	- 定理：**有向连通图$G = (V, E)$关联矩阵$B$的秩$\text{rank}(B)= n-1$**
		- 证明：![[Pasted image 20250611151631.png]]![[Pasted image 20250611151639.png]]
- 基本关联矩阵及其性质：
	- 基本关联矩阵：在$G = <V, E>$的关联矩阵$B$中划去任意点$v_k$所对应的行，得到一个$(n - 1) \times m$矩阵$B_k$
		- 基本关联矩阵的秩为$n-1$
		- n个点的树的基本关联矩阵的秩也为$n-1$
	- 定理：设$B_k$为有向连通图$G$的**基本关联矩阵**，$C$是$G$中的一个**回路**，则$C$中各边所对应$B_k$的各**列相关**
	- 推论：设$H$是有向连通图$G$的子图。若$H$含有回路，则$H$的诸边对应的$G$的基本关联矩阵各列线性相关
	- 定理：令$B_k$是有向连通图$G$的基本关联矩阵，则$B_k$的任意$n -1$阶子阵行列式$\neq 0\Leftrightarrow$其各列所对应的边构成$G$的一棵支撑树
		- 行列式非零的子阵数目和支撑树数目之间存在对应关系
# 支撑树的计数
- 定理——Binet-Cauchy定理：$A = (a_{ij})_{m\times n},B =(b_{ij})_{n\times m},m ≤ n$，则$𝐝𝐞𝐭(𝑨𝑩) = \sum_𝒊𝑨_𝒊𝑩_𝒊$。其中：$A_i$是从$A$中取不同的$m$列所成的行列式，$B_i$是从$B$中取相应的$m$行构成的行列式
- 支撑树的计数：
	- 定理：设$B_0$为$B(G)$的任意一$k$阶方阵，则$|B_0| = ±1$或$0$
		- 证明：![[Pasted image 20250611154449.png]]![[Pasted image 20250611154454.png]]
	- 定理：设$B_k$是有向连通图$G = <V, E>$的某一基本关联矩阵，则G的不同树的数目是$\det(𝑩_k𝑩_k^T)$
		- 证明：![[Pasted image 20250611154611.png]]
	- 应用：
		- 不含特定边的支撑树数目：在关联矩阵中减去对应的边即可
		- 必含特定边的支撑树数目：可使用**边收缩变换**，或使用简单的原支撑树数目**减去不含特定边支撑树数目的办法**
		- 无向连通图支撑树的计数：各边随意的添加方向，对应的支撑树数目不变
- 根树的计数：
	- 定义：$T$是有向树，若$T$中存在某节点$v_0$的入度为$0$，其余节点入度为$1$，则称$T$是以$v_0$为根的外向树，或称根树，用$\overrightarrow 𝑻$表示
	- 根数的基本关联矩阵：
		- 去掉关联矩阵中树根对应节点的行，得到根树的基本关联矩阵
		- 特征：每行每列只有一个-1元素
		- 性质：若进行列交换操作，根树的基本关联矩阵变为**上三角矩阵，且对角元均为-1**。因此，将所有的1变为0，行列式不变
	- 定理：设$\overrightarrow {\pmb B_k}$表示有向连通图$G$的基本关联矩阵${\pmb B_k}$中将全部1改为0之后的矩阵，则$G$中以$v_k$为根的根树数目是$\det(\overrightarrow 𝑩_k𝑩_k^𝑻)$
		- 证明：![[Pasted image 20250611160523.png]]
		- 应用：
			- 求不过某边的根树数目：类似，删去边即可
			- 求**必过**某边的根树数目：相减，或：**由于这条边$e=(u,v)$被指定，则其他的进入$v$的边$(t,v)$一定不在根树中，删去后求根树数目即可**
# 回路矩阵与割集矩阵
## 回路矩阵
- 完全回路矩阵：有向连通图 $G$ 的全部**初级回路**构成的矩阵，称为 $G$ 的**完全回路矩阵**，记为$C_e$。它的元素为：$$c_{ij}=\begin{cases}1&e_j\in C_i且方向一致\\-1&e_j\in C_i且方向相反\\0&\text{其他}\\\end{cases}$$
	- 每行表示一个回路，每列表示一条边
	- 最多可能有$2^{m-n+1}$个回路
	- 例：![[Pasted image 20250415151830.png]]
- 基本回路矩阵：当有向图 $G = (V , E)$ 的生成树 $T$ 确定以后每条余树边 $e$ 所对应的回路称为**基本回路**，该回路的方向与 $e$ 的方向一致。由全部基本回路构成的矩阵称为 $G$ 的**基本回路矩阵**，记为 $C_f$ 
	- 例：![[Pasted image 20250415151940.png]]
	- 对基本回路矩阵做初等变换，使得树T的边在后，余树的边在前，可以转换为分块矩阵$\pmb{[I\quad C_{f12}]}$的形式
- 回路矩阵的性质：
	- 定理：有向连通图 $G = <V , E>$ 的关联矩阵 $B$ 和完全回路矩阵 $C_e$ 的边次序一致时，恒有$𝑩𝑪_𝒆^𝑻=𝟎$。
		- 证明：![[Pasted image 20250415155256.png]]![[Pasted image 20250415155310.png]]
	- 定理：有向连通图 $G = <V , E>$ 的完全回路矩阵$C_e$的秩为$m-n+1$
		- 证明：![[Pasted image 20250415155423.png]]
	- 定义：由连通图 $G$ 中 $m-n +1$ 个互相独立的回路组成的矩阵 $C$ ，称为 $G$ 的回路矩阵
		- 性质：
			- 基本回路矩阵$C_f$是回路矩阵
			- $BC^T=0$（边次序一致）
			- $C=PC_f$（边次序一致，且$P$是一个非奇异的方阵）
	- 定理：连通图 $G$ 的回路矩阵 $C$ 的任一$m-n +1$阶子阵行列式非 0 当且仅当这些列对应于 $G$ 的某一棵余树（**余树与其回路矩阵之间的关系**）
		- 证明：![[Pasted image 20250415155726.png]]![[Pasted image 20250415155732.png]]
	- 定理：若有向连通图 $G = <V , E>$ 的基本关联矩阵 $B_k$ 和基本回路矩阵 $C_f$ 的边次序一致，并设$$C_f=[I\quad C_{f12}],B_k=[B_{11}\quad B_{12}]$$则$\pmb{C_{f12}=-B_{11}^TB_{12}^{-T}}$（**基本回路矩阵的求法**）
		- 证明：![[Pasted image 20250415160028.png]]
		- 例：![[Pasted image 20250415160043.png]]![[Pasted image 20250415160050.png]]![[Pasted image 20250415160059.png]]
## 割集矩阵
- 边割集：设 $S$ 是图 $G = <V , E>$ 的边子集，若$G'= <V , E-S>$ 比 $G$ 的连通分支数多 1，且对$\forall S' \subset S$，$G$ 与 $G '' = <V , E-S'>$ 的连通分支数相同（即刚好可以将原图分割为两个连通支）则称 $S$ 为 $G$ 的一个边割集
	- 有向割集：对有向图来说，给割集 $S$ 一个方向（$\forall e\in S$，$e$ 或与 $S$ 同向，或与 $S$ 反向）
- 完全割集矩阵：有向连通图 $G$ 的全部割集组成的矩阵，称为完全割集矩阵，记为 $S_e$ 。其中：$$S_{ij}=\begin{cases}1&e_j\in S_i且与S_i方向一致\\-1&e_j\in S_i且与S_i方向相反\\0&其他\\\end{cases}$$
	- 例：![[Pasted image 20250415184450.png]]
	- 性质：对n个点的图，最多有$2^{n-1}-1$个不同的割集
- 基本割集矩阵：设 $T$ 是连通图 $G$ 的一棵树，$e_i$ 是 $T$ 的一条边，对应 $e_i$ 存在 $G$ 的割集 $S_i$，$S_i$ 只包括一条树上的边及某些余树边，且与 $e_i$ 的方向一致。这时称 $S_i$ 为 $G$ 的对应树 $T$ 的一个**基本割集**。给定有向连通图 $G$ 的一棵树，则由全部基本割集组成的矩阵称为**基本割集矩阵**，记为 $S_f$
	- 例：![[Pasted image 20250415184747.png]]
	- 同样，对列做交换，将树对应的边放在后面，余树边对应的放在前面，且与割集的次序一致，则有$\pmb {S_f=[S_{f11}\quad I]}$
		- 显然，基本割集矩阵的秩为$n-1$
- 割集矩阵的性质：
	- 定理：当有向连通图 $G$ 的完全回路矩阵 $C_e$ 和完全割集矩阵 $S_e$ 的边次序一致时，有 $𝑺_𝒆𝑪_𝒆^𝑻=𝟎$
		- 证明：![[Pasted image 20250415185213.png]]
	- 定理：有向连通图 $G$ 的完全割集矩阵 $S_e$ 的秩为$n-1$
		- 证明：![[Pasted image 20250415185258.png]]
	- 定义：连通图 $G$ 的 $n-1$ 个互相独立的割集构成的矩阵称为 $G$ 的割集矩阵，记为 $S$
		- 性质：
			- 基本割集矩阵 $S_f$ 是割集矩阵
			- $SC^T = 0$ （$S$ 和 $C$ 的边次序一致）
			- $S = PS_f$ ，其中 $P$ 为非奇异方阵，$S$ 与 $S_f$ 的边次序一致
	- 定理：连通图 $G = <V , E>$的割集矩阵 S 的任一 $n-1$ 阶子阵行列式非 0 ，当且仅当这些列对应于 $G$ 的某棵树
	- 定理：有向连通图 $G = <V , E>$中关于某棵树的基本割集矩阵 $S_f$ 和基本回路矩阵 $C_f$ 的边次序一致，并设：$$𝑺_𝒇=[𝑺_{𝒇𝟏𝟏}\quad𝑰],𝑪_𝒇=[𝑰\quad 𝑪_{𝒇𝟏𝟐}]$$则$𝑺_{𝒇𝟏𝟏}=−𝑪_{𝒇𝟏𝟐}^𝑻$
	- 定理：（**求基本割集矩阵**）若连通图 $G = <V , E>$ 的基本割集矩阵与基本关联矩阵的边次序一致时，有$𝑺_{𝒇𝟏𝟏}=𝑩_{𝟏𝟐}^{−𝟏}𝑩_{𝟏𝟏}$
# 最短树
- 最小支撑树（最短树）：
	- 定义：一棵支撑树中的所有边的权之和称为该支撑树的权。具有最小权的支撑树，称为最小支撑树
	- 特点：连通，没有回路，权值和最小
- Prim算法：
	- 思想：首先任选一个结点 $v_0$ 构成集合 $V'$，然后不断在 $V-V'$ 中选一条到 $V'$ 中某点（如点 $v$ ）最短的边 $(u , v)$ 进入树 $T$ ，并令$V ' = V ' + u$ ，直至 $V ' = V$
	- 实现：类似Dijkstra算法（可见[[L10 图#^80b13b|数据结构——图的Prim算法]]
	- 复杂度：$O(n^2)$，采用优先级队列优化到$O(m\log n)$
	- 正确性：
		- 定理：设 $V'$ 是赋权连通图 $G = (V , E)$的结点真子集， $e$ 是二端点分跨在 $V'$ 和 $V-V'$ 的最短边，则 $G$ 中一定存在包含 $e$ 的最短树 $T$
- Kruskal算法： ^6a4dd6
	- 思想：不断地往 $T$ 中添加当前的最短边，如果此时会构成回路，那么它一定是这个回路的最长边，删之。直至最后达到 $n-1$ 条边为止
	- 实现：![[Pasted image 20250415192952.png]]
	- 关键点：如何判断是否形成回路。方法：
		1. 首先将 $G$ 的 $n$ 个顶点看成 $n$ 个孤立的连通分支
		2. 将所有的边按权从小到大排序
		3. 依边权递增的顺序查看每一条边 $(v , w)$
			- 若 $v$ 和 $w$ 分别是当前 2 个不同的连通分支（树） $T_1$和 $T_2$中的顶点时，就用边 $(v , w)$ 将 $T_1$ 和 $T_2$ 连接成一个连通分支（树），然后接着查看下一条边
			- 若 $v$ 和 $w$ 在当前的同一个连通分支中，就直接再查看下一条边
		4. 重复步骤 3 一直进行到只剩下一个连通分支时为止	
	- 复杂度：$O(m+p\log m)$，$p$为迭代次数
	- 正确性：
		- 证明：![[Pasted image 20250415193740.png]]
- 说明：稠密图适用于Prim算法，稀疏图适用于Kruskal算法
# Huffman树
- [[L6 二叉树#^a3018d|数据结构——Huffman编码树]]
- [[L5 贪心算法#哈夫曼编码|算法分析与设计——Huffman编码与贪心算法]]