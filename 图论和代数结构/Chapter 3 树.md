# 树的基本概念
# 基本关联矩阵
# 支撑树的计数
- 定理——Binet-Cauchy定理：$A = (a_{ij})_{m\times n},B =(b_{ij})_{n\times m},m ≤ n$，则$𝐝𝐞𝐭(𝑨𝑩) = \sum_𝒊𝑨_𝒊𝑩_𝒊$。其中：$A_i$是从$A$中取不同的$m$列所成的行列式，$B_i$是从$B$中取相应的$m$行构成的行列式
- 根树的定义：
- 根树的性质：


# 回路矩阵与割集矩阵
## 回路矩阵
- 完全回路矩阵：有向连通图 $G$ 的全部**初级回路**构成的矩阵，称为 $G$ 的**完全回路矩阵**，记为$C_e$。它的元素为：$$c_{ij}=\begin{cases}1&e_j\in C_i且方向一致\\-1&e_j\in C_i且方向相反\\0&\text{其他}\\\end{cases}$$
	- 每行表示一个回路，每列表示一条边
	- 最多可能有$2^{m-n+1}$个回路
	- 例：![[Pasted image 20250415151830.png]]
- 基本回路矩阵：当有向图 $G = (V , E)$ 的生成树 $T$ 确定以后每条余树边 $e$ 所对应的回路称为**基本回路**，该回路的方向与 $e$ 的方向一致。由全部基本回路构成的矩阵称为 $G$ 的**基本回路矩阵**，记为 $C_f$ 
	- 例：![[Pasted image 20250415151940.png]]
	- 对基本回路矩阵做初等变换，使得树T的边在后，余树的边在前，可以转换为分块矩阵$\pmb{[I\quad C_{f12}]}$的形式
- 回路矩阵的性质：
	- 定理：有向连通图 $G = <V , E>$ 的关联矩阵 $B$ 和完全回路矩阵 $C_e$ 的边次序一致时，恒有$𝑩𝑪_𝒆^𝑻=𝟎$。
		- 证明：![[Pasted image 20250415155256.png]]![[Pasted image 20250415155310.png]]
	- 定理：有向连通图 $G = <V , E>$ 的完全回路矩阵$C_e$的秩为$m-n+1$
		- 证明：![[Pasted image 20250415155423.png]]
	- 定义：由连通图 $G$ 中 $m-n +1$ 个互相独立的回路组成的矩阵 $C$ ，称为 $G$ 的回路矩阵
		- 性质：
			- 基本回路矩阵$C_f$是回路矩阵
			- $BC^T=0$（边次序一致）
			- $C=PC_f$（边次序一致，且$P$是一个非奇异的方阵）
	- 定理：连通图 $G$ 的回路矩阵 $C$ 的任一$m-n +1$阶子阵行列式非 0 当且仅当这些列对应于 $G$ 的某一棵余树（**余树与其回路矩阵之间的关系**）
		- 证明：![[Pasted image 20250415155726.png]]![[Pasted image 20250415155732.png]]
	- 定理：若有向连通图 $G = <V , E>$ 的基本关联矩阵 $B_k$ 和基本回路矩阵 $C_f$ 的边次序一致，并设$$C_f=[I\quad C_{f12}],B_k=[B_{11}\quad B_{12}]$$则$\pmb{C_{f12}=-B_{11}^TB_{12}^{-T}}$（**基本回路矩阵的求法**）
		- 证明：![[Pasted image 20250415160028.png]]
		- 例：![[Pasted image 20250415160043.png]]![[Pasted image 20250415160050.png]]![[Pasted image 20250415160059.png]]
## 割集矩阵
- 边割集：设 $S$ 是图 $G = <V , E>$ 的边子集，若$G'= <V , E-S>$ 比 $G$ 的连通分支数多 1，且对$\forall S' \subset S$，$G$ 与 $G '' = <V , E-S'>$ 的连通分支数相同（即刚好可以将原图分割为两个连通支）则称 $S$ 为 $G$ 的一个边割集
	- 有向割集：对有向图来说，给割集 $S$ 一个方向（$\forall e\in S$，$e$ 或与 $S$ 同向，或与 $S$ 反向）
- 完全割集矩阵：有向连通图 $G$ 的全部割集组成的矩阵，称为完全割集矩阵，记为 $S_e$ 。其中：$$S_{ij}=\begin{cases}1&e_j\in S_i且与S_i方向一致\\-1&e_j\in S_i且与S_i方向相反\\0&其他\\\end{cases}$$
	- 例：![[Pasted image 20250415184450.png]]
	- 性质：对n个点的图，最多有$2^{n-1}-1$个不同的割集
- 基本割集矩阵：设 $T$ 是连通图 $G$ 的一棵树，$e_i$ 是 $T$ 的一条边，对应 $e_i$ 存在 $G$ 的割集 $S_i$，$S_i$ 只包括一条树上的边及某些余树边，且与 $e_i$ 的方向一致。这时称 $S_i$ 为 $G$ 的对应树 $T$ 的一个**基本割集**。给定有向连通图 $G$ 的一棵树，则由全部基本割集组成的矩阵称为**基本割集矩阵**，记为 $S_f$
	- 例：![[Pasted image 20250415184747.png]]
	- 同样，对列做交换，将树对应的边放在后面，余树边对应的放在前面，且与割集的次序一致，则有$\pmb {S_f=[S_{f11}\quad I]}$
		- 显然，基本割集矩阵的秩为$n-1$
- 割集矩阵的性质：
	- 定理：当有向连通图 $G$ 的完全回路矩阵 $C_e$ 和完全割集矩阵 $S_e$ 的边次序一致时，有 $𝑺_𝒆𝑪_𝒆^𝑻=𝟎$
		- 证明：![[Pasted image 20250415185213.png]]
	- 定理：有向连通图 $G$ 的完全割集矩阵 $S_e$ 的秩为$n-1$
		- 证明：![[Pasted image 20250415185258.png]]
	- 定义：连通图 $G$ 的 $n-1$ 个互相独立的割集构成的矩阵称为 $G$ 的割集矩阵，记为 $S$
		- 性质：
			- 基本割集矩阵 $S_f$ 是割集矩阵
			- $SC^T = 0$ （$S$ 和 $C$ 的边次序一致）
			- $S = PS_f$ ，其中 $P$ 为非奇异方阵，$S$ 与 $S_f$ 的边次序一致
	- 定理：连通图 $G = <V , E>$的割集矩阵 S 的任一 $n-1$ 阶子阵行列式非 0 ，当且仅当这些列对应于 $G$ 的某棵树
	- 定理：有向连通图 $G = <V , E>$中关于某棵树的基本割集矩阵 $S_f$ 和基本回路矩阵 $C_f$ 的边次序一致，并设：$$𝑺_𝒇=[𝑺_{𝒇𝟏𝟏}\quad𝑰],𝑪_𝒇=[𝑰\quad 𝑪_{𝒇𝟏𝟐}]$$则$𝑺_{𝒇𝟏𝟏}=−𝑪_{𝒇𝟏𝟐}^𝑻$
	- 定理：（**求基本割集矩阵**）若连通图 $G = <V , E>$ 的基本割集矩阵与基本关联矩阵的边次序一致时，有$𝑺_{𝒇𝟏𝟏}=𝑩_{𝟏𝟐}^{−𝟏}𝑩_{𝟏𝟏}$
# 最短树
- 最小支撑树（最短树）：
	- 定义：一棵支撑树中的所有边的权之和称为该支撑树的权。具有最小权的支撑树，称为最小支撑树
	- 特点：连通，没有回路，权值和最小
- Prim算法：
	- 思想：首先任选一个结点 $v_0$ 构成集合 $V'$，然后不断在 $V-V'$ 中选一条到 $V'$ 中某点（如点 $v$ ）最短的边 $(u , v)$ 进入树 $T$ ，并令$V ' = V ' + u$ ，直至 $V ' = V$
	- 实现：类似Dijkstra算法（可见[[L10 图#^80b13b|数据结构——图的Prim算法]]
	- 复杂度：$O(n^2)$，采用优先级队列优化到$O(m\log n)$
	- 正确性：
		- 定理：设 $V'$ 是赋权连通图 $G = (V , E)$的结点真子集， $e$ 是二端点分跨在 $V'$ 和 $V-V'$ 的最短边，则 $G$ 中一定存在包含 $e$ 的最短树 $T$
- Kruskal算法： ^6a4dd6
	- 思想：不断地往 $T$ 中添加当前的最短边，如果此时会构成回路，那么它一定是这个回路的最长边，删之。直至最后达到 $n-1$ 条边为止
	- 实现：![[Pasted image 20250415192952.png]]
	- 关键点：如何判断是否形成回路。方法：
		1. 首先将 $G$ 的 $n$ 个顶点看成 $n$ 个孤立的连通分支
		2. 将所有的边按权从小到大排序
		3. 依边权递增的顺序查看每一条边 $(v , w)$
			- 若 $v$ 和 $w$ 分别是当前 2 个不同的连通分支（树） $T_1$和 $T_2$中的顶点时，就用边 $(v , w)$ 将 $T_1$ 和 $T_2$ 连接成一个连通分支（树），然后接着查看下一条边
			- 若 $v$ 和 $w$ 在当前的同一个连通分支中，就直接再查看下一条边
		4. 重复步骤 3 一直进行到只剩下一个连通分支时为止	
	- 复杂度：$O(m+p\log m)$，$p$为迭代次数
	- 正确性：
		- 证明：![[Pasted image 20250415193740.png]]
- 说明：稠密图适用于Prim算法，稀疏图适用于Kruskal算法
# Huffman树
- [[L6 二叉树#^a3018d|数据结构——Huffman编码树]]
- [[L5 贪心算法#哈夫曼编码|算法分析与设计——Huffman编码与贪心算法]]