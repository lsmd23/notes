# 二分图的最大匹配
- 匹配问题：
	- 例：![[Pasted image 20250506192734.png]]
	- 定义：令$M$是图$G$的**边子集**，若$M$中任**意两条边都没有共同顶点**，则称$M$为$G$的一个匹配，其中与$M$的边**相关联的节点称为饱和点**，否则称为**非饱和点**
		- 设$M$是$G= (V,E)$中的一个匹配，若在$M$中加入任意一条边所得集合都不是匹配，则称$M$为**极大匹配**；如果对$G$的任意匹配$M'$，都有$|M| ≥ |M'|$，则称$M$为一个最大匹配
		- 例：![[Pasted image 20250506193018.png]]
- 二分图的最大匹配：
	- 定义：
		- 给定了$G$的一个匹配$M$，$G$中属于$M$与不属于$M$的边交替出现的道路称为交互道路
		- 设$P$是$G$中关于匹配$M$的一条交互道路，如果$P$的两个端点是关于$M$的非饱和点，那么它就称为可增广道路
		- 性质：
			- 可增广道路$P$一定包含奇数条边，且其中不属于匹配$M$的边比$M$中的边多一条
			- 同时$M'=P ⊕M$仍然是一个匹配，它使$P$的两个端点变成了饱和点，此时$|M'| = |M| + 1$，即$M'$是比$M$更大的匹配
			- 若边$e = v_iv_j$中的两个点都是非饱和点，则$e$也为增广路
	- 定理：$M$为$G$的最大匹配，当且仅当$G$不含关于$M$的可增广路径
		- 证明：![[Pasted image 20250506193756.png]]![[Pasted image 20250506193803.png]]![[Pasted image 20250506193811.png]]
	- 算法：匈牙利算法，输入二分图$G=(X,Y,E)$
		- 对点的标记：0表示尚未搜索；1表示饱和点；2表示是无法扩大匹配的顶点
		1) 任给一初始匹配$M$，给饱和点“1”标记
		2) 判断X中各顶点是否都已有非零标记
			- 若是，结束。$M$为最大匹配
			- 否则，找一“0”标记点$x_0 \in X$
		3) 从$x_0$出发通过深搜或者广搜寻找一条可增广路径
			- 找到从$x_0$到$y_i$的可增广路$P$，令$M\leftarrow M\oplus P$，给$x_0,y_i$标记“1”，转2
			- 搜索完毕没找到，$x_0$无法扩大匹配，给$x_0$标记“2”，转2
		- 复杂度：$O(mn)$
		- 例：
			- ![[Pasted image 20250506194324.png]]![[Pasted image 20250506194330.png]]![[Pasted image 20250506194335.png]]
# 完美匹配
- 定义：设$G= <V_1, V_2, E>$为二分图，$|V_1|\leq |V_2|$，如果$|M| = |V_1|$，则称$M$为$V_1$到$V_2$的完全匹配；若$|V_1| = |V_2|$，则完全匹配为**完美匹配**。**完全匹配为G中最大匹配**
- 定理：(Hall定理)二分图$G= <V_1, V_2, E>$，$|V_1| \leq|V_2|$，$G$中存在从$V_1$到$V_2$的完全匹配，当且仅当$V_1$中任意$k$个顶点至少与$V_2$中的$k$个顶点相邻$(k = 1...|V_1|)$
	- 该条件称为相异性条件
	- 证明：
		- ![[Pasted image 20250506194812.png]]![[Pasted image 20250506194817.png]]
	- 推论：设二分图$G= <V_1, V_2, E>$，$V_1$中每个顶点至少关联$k(k\geq 1)$条边，而$V_2$中每个顶点至多关联$k$条边，则$G$中存在$V_1$到$V_2$的完全匹配。
		- 该条件称为$k(k\geq 1)$条件
		- 证明：
			- ![[Pasted image 20250506194940.png]]
		- 例：![[Pasted image 20250506195200.png]]
- 定理：（**最大匹配边数**）二分图$G = (X, Y, E)$中，$X$到$Y$的最大匹配边数是$|X| - δ(G)$，其中：$A$为$X$中任意个数节点的子集，$\delta(G)=\max_{A\subseteq X}\delta(A)$，$\delta(A)=|A|-|\Gamma(A)|,\delta(A)\geq0$
	- 例：![[Pasted image 20250506200644.png]]
- 最大匹配数：
	- 对二分图，可以用一个$|X|\times|Y|$的矩阵表示；求最大匹配数也即求矩阵中不在同行同列的非零元的最多个数
	- 覆盖：适当地选取$A$的某些行和列，使这些行和列能盖住$A$的全部非零元，这称之为$A$的覆盖
	- 最小覆盖：如果选取最少的行与列就能覆盖$A$的全部非零元，则称这样的覆盖为最小覆盖。
		- 在矩阵$A$的全部覆盖中，一定存在最小覆盖，其覆盖数为$s$，显然$s ≤ \min(|X|, |Y|)$
	- Konig定理：设$r$是二分图$G$的最大匹配数，$s$是其邻接矩阵的最小覆盖数，则有$r = s$
# 最佳匹配
- 若二分图转化为带权二分图，求权最值的匹配
- 定义：如果一带权二分图的边权是非负实数，而且存在多个完全匹配，那么其中**权和最大或最小的匹配就叫最佳匹配**
- 